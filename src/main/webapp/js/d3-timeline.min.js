!function(){d3.timeline=function(){function t(t){function n(t){return _.left+(t.starting_time-v)*q}function c(t){return _.left+(t.starting_time-v)*q+5}function u(){if(g||C.attr("height"))g?C.attr("height",g):g=C.attr("height");else{if(!A)throw"height of the timeline is not set";g=nn.height+nn.top-S.top,d3.select(t[0][0]).attr("height",g)}}function l(){if(f||S.width){if(!f||!S.width)try{f=C.attr("width")}catch(t){console.log(t)}}else try{if(f=C.attr("width"),!f)throw"width of the timeline is not set. As of Firefox 27, timeline().with(x) needs to be explicitly set in order to render"}catch(t){console.log(t)}}function k(n,e){t.append("svg:line").attr("x1",n).attr("y1",e.marginTop).attr("x2",n).attr("y2",g-e.marginBottom).style("stroke",e.color).style("stroke-width",e.width)}var B=t.append("g"),S=t[0][0].getBoundingClientRect(),C=d3.select(t[0][0]),R={},j=1,D=0,N=0;l(),F&&B.each(function(t){t.forEach(function(t,n){t.times.forEach(function(t,e){0===n&&0===e?(originTime=t.starting_time,t.starting_time=0,t.ending_time=t.ending_time-originTime):(t.starting_time=t.starting_time-originTime,t.ending_time=t.ending_time-originTime)})})}),(T||0===y||0===v)&&(B.each(function(t){t.forEach(function(t,n){T&&-1==Object.keys(R).indexOf(n)&&(R[n]=j,j++),t.times.forEach(function(t){0===v&&(t.starting_time<D||0===D&&F===!1)&&(D=t.starting_time),0===y&&t.ending_time>N&&(N=t.ending_time)})})}),0===y&&(y=N),0===v&&(v=D));var q=1/(y-v)*(f-_.left-_.right),G=d3.time.scale().domain([v,y]).range([_.left,f-_.right]),J=d3.svg.axis().scale(G).orient(s).tickFormat(d.format).ticks(d.numTicks||d.tickTime,d.tickInterval).tickSize(d.tickSize);B.each(function(o){P=o,o.forEach(function(o,u){function l(){return T?_.top+(A+E)*R[u]:_.top}function s(){return T?_.top+(A+E)*R[u]+.75*A:_.top+.75*A}var g=o.times,d="undefined"!=typeof o.label;if("undefined"!=typeof o.id&&console.warn("d3Timeline Warning: Ids per dataset is deprecated in favor of a 'class' key. Ids are now per data element."),h&&Q(R,u,B,g,o),B.selectAll("svg").data(g).enter().append(function(t){return document.createElementNS(d3.ns.prefix.svg,"display"in t?t.display:w)}).attr("x",n).attr("y",l).attr("width",function(t){return(t.ending_time-t.starting_time)*q}).attr("cy",function(t,n){return l(t,n)+A/2}).attr("cx",n).attr("r",A/2).attr("height",A).style("fill",function(t){var n;return t.color?t.color:x?(n=t[x],p(n?n:o[x])):p(u)}).on("mousemove",function(t){e(t,u,o)}).on("mouseover",function(t,n){r(t,n,o)}).on("mouseout",function(t,n){i(t,n,o)}).on("click",function(t){a(t,u,o)}).attr("class",function(){return o["class"]?"timelineSeries_"+o["class"]:"timelineSeries_"+u}).attr("id",function(t,n){return o.id&&!t.id?"timelineItem_"+o.id:t.id?t.id:"timelineItem_"+u+"_"+n}),B.selectAll("svg").data(g).enter().append("text").attr("x",c).attr("y",s).text(function(t){return t.label}),m){var v=A+E/2+_.top+(A+E)*R[u];t.append("svg:line").attr("class","row-seperator").attr("x1",0+_.left).attr("x2",f-_.right).attr("y1",v).attr("y2",v).attr("stroke-width",1).attr("stroke",m)}d&&U(t,R,u,d,o),"undefined"!=typeof o.icon&&t.append("image").attr("class","timeline-label").attr("transform","translate(0,"+(_.top+(A+E)*R[u])+")").attr("xlink:href",o.icon).attr("width",_.left).attr("height",A)})});var V=_.top+(A+E)*j,X=_.top,Z=Y?X:V;if(I&&W(B,J,Z),M&&K(B,J,j),f>S.width){var $=function(){var t=Math.min(0,Math.max(S.width-f,d3.event.translate[0]));tn.translate([t,0]),B.attr("transform","translate("+t+",0)"),o(t*q,G)},tn=d3.behavior.zoom().x(G).on("zoom",$);t.attr("class","scrollable").call(tn)}b&&B.selectAll(".tick text").attr("transform",function(){return"rotate("+b+")translate("+(this.getBBox().width/2+10)+","+this.getBBox().height/2+")"});var nn=B[0][0].getBoundingClientRect();if(u(),H&&B.each(function(t){t.forEach(function(t){var n=t.times;n.forEach(function(t){k(G(t.starting_time),L),k(G(t.ending_time),L)})})}),z){var en=G(new Date);k(en,O)}}var n=["circle","rect"],e=function(){},r=function(){},i=function(){},a=function(){},o=function(){},c=function(t){return t},u=function(){},l=function(){},s="bottom",f=null,g=null,m=null,h=null,d={format:d3.time.format("%I %p"),tickTime:d3.time.hours,tickInterval:1,tickSize:6},p=d3.scale.category20(),x=null,w="rect",v=0,k=0,y=0,_={left:30,right:30,top:30,bottom:30},T=!1,b=!1,F=!1,B=!1,A=20,E=5,S=60,I=!0,Y=!1,z=!1,M=!1,C={stroke:"stroke-dasharray",spacing:"4 10"},O={marginTop:25,marginBottom:0,width:1,color:p},H=!1,L={marginTop:25,marginBottom:0,width:1,color:p},R=!1,j=!1,D=!1,N="white",P={},W=function(t,n,e){R&&J(t,0,0),j&&G(t);t.append("g").attr("class","axis").attr("transform","translate(0,"+e+")").call(n)},q=function(t){var n=v.getFullYear();v.getFullYear()!=y.getFullYear()&&(n=v.getFullYear()+"-"+y.getFullYear()),t.append("text").attr("transform","translate(20, 0)").attr("x",0).attr("y",14).attr("class","calendarYear").text(n)},G=function(t){var n=6,e=_.left-S,r=(f-_.left)/n,i=f-_.right-r+S,a=t.append("g").attr("class","axis").attr("transform","translate(0, 20)");D&&q(a),a.append("text").attr("transform","translate("+e+", 0)").attr("x",0).attr("y",14).attr("class","chevron").text("<").on("click",function(){return u(v,P)}),a.append("text").attr("transform","translate("+i+", 0)").attr("x",0).attr("y",14).attr("class","chevron").text(">").on("click",function(){return l(y,P)})},J=function(t,n,e){t.insert("rect").attr("class","row-green-bar").attr("x",n).attr("width",f).attr("y",e).attr("height",A).attr("fill",N)},K=function(t,n,e){t.append("g").attr("class","axis").attr("transform","translate(0,"+(_.top+(A+E)*e)+")").attr(C.stroke,C.spacing).call(n.tickFormat("").tickSize(-(_.top+(A+E)*(e-1)+3),0,0))},Q=function(t,n,e,r,i){var a=(A+E)*t[n]+_.top;e.selectAll("svg").data(r).enter().insert("rect").attr("class","row-green-bar").attr("x",B?0:_.left).attr("width",B?f:f-_.right-_.left).attr("y",a).attr("height",A).attr("fill",h instanceof Function?h(i,n):h)},U=function(t,n,e,r,i){var o=A+E,u=o+o*(n[e]||1);t.append("text").attr("class","timeline-label").attr("transform","translate("+k+","+u+")").text(r?c(i.label):i.id).on("click",function(t){a(t,e,i)})};return t.margin=function(n){return arguments.length?(_=n,t):_},t.orient=function(n){return arguments.length?(s=n,t):s},t.itemHeight=function(n){return arguments.length?(A=n,t):A},t.itemMargin=function(n){return arguments.length?(E=n,t):E},t.navMargin=function(n){return arguments.length?(S=n,t):S},t.height=function(n){return arguments.length?(g=n,t):g},t.width=function(n){return arguments.length?(f=n,t):f},t.display=function(e){return arguments.length&&-1!=n.indexOf(e)?(w=e,t):w},t.labelFormat=function(n){return arguments.length?(c=n,t):null},t.tickFormat=function(n){return arguments.length?(d=n,t):d},t.hover=function(n){return arguments.length?(e=n,t):e},t.mouseover=function(n){return arguments.length?(r=n,t):n},t.mouseout=function(n){return arguments.length?(i=n,t):n},t.click=function(n){return arguments.length?(a=n,t):a},t.scroll=function(n){return arguments.length?(o=n,t):o},t.colors=function(n){return arguments.length?(p=n,t):p},t.beginning=function(n){return arguments.length?(v=n,t):v},t.ending=function(n){return arguments.length?(y=n,t):y},t.labelMargin=function(n){return arguments.length?(k=n,t):y},t.rotateTicks=function(n){return b=n,t},t.stack=function(){return T=!T,t},t.relativeTime=function(){return F=!F,t},t.showBorderLine=function(){return H=!H,t},t.showBorderFormat=function(n){return arguments.length?(L=n,t):L},t.showToday=function(){return z=!z,t},t.showTodayFormat=function(n){return arguments.length?(O=n,t):O},t.colorProperty=function(n){return arguments.length?(x=n,t):x},t.rowSeperators=function(n){return arguments.length?(m=n,t):m},t.background=function(n){return arguments.length?(h=n,t):h},t.showTimeAxis=function(){return I=!I,t},t.showAxisTop=function(){return Y=!Y,t},t.showAxisCalendarYear=function(){return D=!D,t},t.showTimeAxisTick=function(){return M=!M,t},t.fullLengthBackgrounds=function(){return B=!B,t},t.showTimeAxisTickFormat=function(n){return arguments.length?(C=n,t):C},t.showAxisHeaderBackground=function(n){return R=!R,n&&(N=n),t},t.navigate=function(n,e){return u=n,l=e,j=!j,t},t}}();